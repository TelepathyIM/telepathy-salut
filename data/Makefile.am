# Telepathy manager file
managerdir = $(datadir)/telepathy/managers
manager_DATA = salut.manager

# Dbus service file
servicedir = $(DBUS_SERVICES_DIR)
service_in_files = org.freedesktop.Telepathy.ConnectionManager.salut.service.in
service_DATA = $(service_in_files:.service.in=.service)

BUILT_FILES = $(service_DATA) $(manager_DATA)

CLEANFILES = $(BUILT_FILES)

EXTRA_DIST = $(service_in_files)

# Rule to make the service file with libexecdir expanded
$(service_DATA): $(service_in_files) Makefile
	@sed -e "s|\@libexecdir\@|$(libexecdir)|" $< > $@

$(manager_DATA): always-build
	$(MAKE) -C ../src write-mgr-file
	../src/write-mgr-file > $@

.PHONY: always-build
